<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="home :: header">
    <style>
        .active {
            background-color: #007bff;
            color: #fff;
        }
    </style>
</head>
<head>
    <script th:inline="javascript">
        $(document).ready(function () {
            <!-- cityId ì„ íƒ ë˜ì—ˆì„ ë•Œ districtList ì–»ì–´ì˜¤ëŠ” ajax -->
            $('#sido').change(function () {
                var selectedCityId = $(this).val();
                $.ajax({
                    type: 'GET',
                    url: '/districts/list/' + selectedCityId,
                    success: function (data) {
                        var options = '';
                        $.each(data, function (index, district) {
                            options += '<option value="' + district.id + '">' + district.districtName + '</option>';
                        });
                        $('#sigungu').html(options);
                    },
                    error: function (xhr, status, error) {
                        console.error('Failed to retrieve district list:', error);
                    }
                });
            });
            <!-- cityId ì„ íƒ ë˜ì—ˆì„ ë•Œ districtList ì–»ì–´ì˜¤ëŠ” ajax END -->

            <!-- ì¹´í…Œê³ ë¦¬ ë§í¬ í´ë¦­ ì‹œ Ajax ìš”ì²­ì„ ë³´ë‚´ì„œ List<storeDTO> ë°›ì•„ì™€ ì¶œë ¥ -->
            $('[id^=categoryLink]').click(function (e) {
                e.preventDefault();
                <!-- í´ë¦­í•œ í•œì¤‘ì¼ì–‘ì¹´ a íƒœê·¸ css ì ìš© -->
                // ëª¨ë“  ì¹´í…Œê³ ë¦¬ ë§í¬ì—ì„œ active í´ë˜ìŠ¤ ì œê±°
                $('[id^=categoryLink]').removeClass('active');
                // í´ë¦­í•œ ì¹´í…Œê³ ë¦¬ ë§í¬ì— active í´ë˜ìŠ¤ ì¶”ê°€
                $(this).addClass('active');
                <!-- í´ë¦­í•œ í•œì¤‘ì¼ì–‘ì¹´ a íƒœê·¸ css ì ìš© END -->

                var categoryId = $(this).find('input[type="hidden"]').val();
                var selectedDistrictId = $('#sigungu').val();

                // ìƒˆë¡œìš´ URI êµ¬ì„±
                var newUrl = '/stores/category/' + categoryId + '/district/' + selectedDistrictId;

                $.ajax({
                    type: 'GET',
                    url: newUrl,
                    success: function (data) {
                        // ì´ì „ ë‚´ìš©ì„ ì§€ìš°ê¸°
                        $('#storeDTOContainer').empty();

                        // ë°›ì•„ì˜¨ dataë¥¼ ë¬¸ì¥ ë§Œë“¤ì–´ storeCard ë³€ìˆ˜ì— ì €ì¥í•´ì„œ $('#storeDTOContainer') ì¶”ê°€í•˜ëŠ” ì‘ì—… ë°˜ë³µìˆ˜í–‰
                        $.each(data, function (index, storeDTO) {
                            var storeCard = '<div class="col-xl-3 col-md-6 mb-4">' +
                                '<div class="card border-left-info shadow h-100 py-2">' +
                                '<div class="card-body">' +
                                '<div class="row no-gutters align-items-center">' +
                                '<div class="col mr-2">' +
                                '<div class="text-xs font-weight-bold text-warning text-uppercase mb-1">' + storeDTO.storeStatus + '</div>' +
                                '<a href="/stores/detail/' + storeDTO.id + '">' +
                                '<div class="h5 mb-0 font-weight-bold text-gray-800">' + storeDTO.storeName + '</div>' +
                                '</a>' +
                                '<div class="text-xs font-weight-bold text-primary text-uppercase mb-1">' + storeDTO.cityName + ' ' + storeDTO.districtName + ' ' + storeDTO.detailAddress + '</div>' +
                                '<div class="text-xs font-weight-bold text-success text-uppercase mb-1">' +'ğŸ•™ '+ storeDTO.openingTime + '-' + storeDTO.closingTime + '</div>' +
                                '</div>' +
                                '<div class="col-auto">' +
                                '<a href="/stores/detail/' + storeDTO.id + '">' +
                                '<img src="/img/' + storeDTO.storeName + '.PNG" alt="ê°€ê²Œ ì´ë¯¸ì§€" style="width: 80px; height: auto;">' +
                                '</a>' +
                                '</div>' +
                                '</div>' +
                                '</div>' +
                                '</div>' +
                                '</div>';

                            // $('#storeDTOContainer')ì— storeCard ë¬¸ì¥ ì¶”ê°€
                            $('#storeDTOContainer').append(storeCard);
                        });

                        // $('#storeDTOContainer') ë§Œë“¤ì—ˆë˜ ë°˜ë³µë¬¸ë¬¸ì¥ ë³´ì—¬ì£¼ê¸°
                        $('#storeDTOContainer').show();
                    },
                    error: function (xhr, status, error) {
                        console.error('Failed to retrieve store list:', error);
                    }
                });
            });
            <!-- ì¹´í…Œê³ ë¦¬ ë§í¬ í´ë¦­ ì‹œ Ajax ìš”ì²­ì„ ë³´ë‚´ì„œ List<storeDTO> ë°›ì•„ì™€ ì¶œë ¥ END -->

        });
    </script>
</head>
<body id="page-top" th:classappend="${bodyClass}">
<!-- Page Wrapper -->
<div id="wrapper">
    <!-- Sidebar -->
    <div th:replace="home :: sidebar"/>
    <!-- End of Sidebar -->
    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
            <!-- Topbar -->
            <div th:replace="home :: topbar"/>
            <!-- End of Topbar -->

            <!-- Begin Page Content -->
            <div class="container-fluid">
                <!-- Page Heading -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">ì¹´í…Œê³ ë¦¬ ì„ íƒ</h6>
                    </div>
                    <div class="card-body">
                        <!-- ì¹´í…Œê³ ë¦¬(í•œì‹/ì¤‘ì‹/ì¼ì‹/ì–‘ì‹/ì¹´í˜) í´ë¦­ ë¶€ë¶„ -->
                        <a id="categoryLink0" href="#" class="btn btn-primary btn-icon-split">
                            <input type="hidden" id="category0Id" th:value="${categoryList[0].getId()}"/>
                            <span class="text" th:text="${categoryList[0].getCategoryName()}"></span>
                        </a>
                        <a id="categoryLink1" href="#" class="btn btn-success btn-icon-split">
                            <input type="hidden" id="category1Id" th:value="${categoryList[1].getId()}"/>
                            <span class="text" th:text="${categoryList[1].getCategoryName()}"></span>
                        </a>
                        <a id="categoryLink2" href="#" class="btn btn-info btn-icon-split">
                            <input type="hidden" id="category2Id" th:value="${categoryList[2].getId()}"/>
                            <span class="text" th:text="${categoryList[2].getCategoryName()}"></span>
                        </a>
                        <a id="categoryLink3" href="#" class="btn btn-warning btn-icon-split">
                            <input type="hidden" id="category3Id" th:value="${categoryList[3].getId()}"/>
                            <span class="text" th:text="${categoryList[3].getCategoryName()}"></span>
                        </a>
                        <a id="categoryLink4" href="#" class="btn btn-danger btn-icon-split">
                            <input type="hidden" id="category4Id" th:value="${categoryList[4].getId()}"/>
                            <span class="text" th:text="${categoryList[4].getCategoryName()}"></span>
                        </a>
                        <!-- ì¹´í…Œê³ ë¦¬(í•œì‹/ì¤‘ì‹/ì¼ì‹/ì–‘ì‹/ì¹´í˜) í´ë¦­ ë¶€ë¶„ END -->

                        <!-- ë„, ì‹œêµ°êµ¬ ìœ„ì¹˜ ì„ íƒ select ë¶€ë¶„ -->
                        <label>ìœ„ì¹˜ ì„ íƒ: </label>
                        <select name="sido" id="sido">-->
                            <option th:each="city : ${cityList}"
                                    th:value="${city.id}"
                                    th:text="${city.cityName}"></option>
                        </select>
                        <select name="sigungu" id="sigungu">
                            <option value="----">----</option>
                        </select>
                        <!-- ë„, ì‹œêµ°êµ¬ ìœ„ì¹˜ ì„ íƒ select ë¶€ë¶„ END -->
                    </div>
                </div>
                <!-- ì—¬ê¸°ì— StoreDTO ì¶œë ¥ -->
                <div class="row" id="storeDTOContainer" style="display: none; flex-wrap: wrap;">
                    <!-- ì—¬ê¸°ì— ajaxë¡œ ë°›ì•„ì˜¨ ê²ƒ forë¬¸ìœ¼ë¡œ ì¶œë ¥(ìœ„ì˜ scriptë¡œ ë°ì´í„° ì…‹íŒ…í•˜ê¸°) -->
                </div>
                <!-- ì—¬ê¸°ì— StoreDTO ì¶œë ¥ END -->
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- End of Main Content -->
    </div>
    <!-- End of Content Wrapper -->
</div>
<!-- End of Page Wrapper -->
<div th:replace="home :: footer"/>
</body>
</html>
